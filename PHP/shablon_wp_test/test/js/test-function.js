////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//	Функции активные сразу после подгрузки заголовка	//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

console.log( "HEAD ready.." );

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

if ( !navigator.cookieEnabled ) {

	console.log( 'Включите cookie ну плиз, что вам сложно что-ли?' );
	
}

document.addEventListener( "DOMContentLoaded", function( ) {

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//	Функции активные после постройки DOM, но до загрузки рисунков	//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

// Получить элементы: над меню, меню, под меню
var header_top		= document.querySelector( '.header-top' );
var header_menu	= document.querySelector( '.header-menu' );
var header_bottom	= document.querySelector( '.header-menu-bottom' );

// Список слайдов, пометить первый
var	sliderDiv		= document.querySelectorAll( '.header-slider div' );
	sliderDiv[ 0 ].classList.add( 'active' );
	
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//	Прокрутка страницы до "крошек"	//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
document.addEventListener( "load", scroll_viewbox( ) );
function scroll_viewbox( ) {

	// До крошек
	document.querySelector( '.header-breadcrumb' ).scrollIntoView( );
	
	// Вычтем меню
	window.scrollBy( 0,-header_menu.clientHeight );
};

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//	Дать следующий слайд	//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
function get_next_slide( ) {

	// Пробежим по элементам
	for ( var i = 0 ; i < sliderDiv.length; i++ ) {
	
		// Найдем активный
		if ( sliderDiv [ i ].className == 'active' ) {
		
			// Снимем класс
			sliderDiv [ i ].classList.remove( 'active' );
			
			// Обошли все элементы коллекции?
			if ( i + 1 === sliderDiv.length ) { 
			
				// Присвоим первому
				sliderDiv [ 0 ].className = 'active'; break 
				
			} else {
			
				// Присвоим следующиму
				sliderDiv [ i + 1 ].className = 'active'; break	
			 };
		};
	};
};

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//	Проверим ширину окна, свернем меню если менее 860px ( 846 + 14 полоса прокрутки )	//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
function check_width_window( ) {

	var classes = header_menu.className;
	
	// Если ширина и нет класса не сворачивать
	if ( ( header_menu.clientWidth < 846 ) && ( classes.indexOf( 'no-flip' ) == -1 ) ) {
	
		// Добавим класс свернуть
		header_menu.classList.add( 'flip' );
		
	} else {
		
		// Развернем
		header_menu.classList.remove( 'flip' );
		
	};
};

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//	При скролле: прилепим меню к верху окна	//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
document.onscroll = function( ) {

	// Координаты ящика сверху меню
	var box_header_top = header_top.getBoundingClientRect( );
	
	// Если низ ящика вышел из зоны видимости 
	if ( box_header_top.bottom < 0 ) {
	
		// Высота меню
		var str = "height:" + header_menu.clientHeight + "px;";
		
		// Ящик с низу меню установим высотой в меню ( добавит плавности )
		header_bottom.setAttribute( 'Style', str );
		
		// Меню в режиме скролла
		header_menu.classList.add ( 'scroll' );
		
	} else {
	
		// Высота ящика 0
		var str = "height:" + 0 + ";";
		
		// Ящик с низу меню установим высотой 0 ( добавит плавности )
		header_bottom.setAttribute( 'Style', str );
		
		// Меню в обычном режиме
		header_menu.classList.remove( 'scroll' );
	}
};

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//	При нажатии на меню: развернуть, скрыть	//
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
header_menu.onclick = function( ) {

	var classes = header_menu.className;
	console.log('m');
	// Если широко, то нет смысла оно развернуто
	if ( header_menu.clientWidth > 846 ) return;
	
	// Если нет класса
	if ( classes.indexOf( 'no-flip' ) == -1 ) { 
	
		// Не сворачивать!
		header_menu.classList.add( 'no-flip' );
		
	} else { 
	
		// Можно сворачивать!
		header_menu.classList.remove( 'no-flip' ); 
	};
};

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

// интервалы для слайдера 
setInterval( function( ) { get_next_slide( ); }, 4000 );
// и проверка состояния меню
setInterval( function( ) { check_width_window( ); }, 500 );

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

console.log( "DOM ready.." );

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

} );


